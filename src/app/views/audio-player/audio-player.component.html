<div class="audio-player" #audioPlayer [ngSwitch]="(streamTypeSelected$ | async)">

  <ng-container *ngSwitchCase="'liveStream'">
    <div class="stream live-stream" >
      <div class="container" >
        <div class="channel">Live Now</div>

        <div class="toggle-play" [class.loading]="(liveStreamLoading$ | async)" [class.playing]="(liveStreamPlaying$ | async)" (click)="liveStreamTogglePlay()">
          <div class="loader" *ngIf="(liveStreamLoading$ | async); else liveStreamControls">
            <div class="spinner"></div>
          </div>

          <ng-template #liveStreamControls>
            <div class="symbol">{{ (liveStreamPlaying$ | async) ? 'stop' : 'play_arrow' }}</div>
          </ng-template>

          <div class="stream-info">{{liveStreamEpisode?.artist}} - {{liveStreamEpisode?.title}}</div>
        </div>

        <div class="side-actions">
          <div class="toggle-expandable-panel" [class.active]="liveStreamExpandablePanelActive" (click)="liveStreamToggleExpandablePanel()">
            <span class="symbol">expand_more</span>
          </div>
        </div>
      </div>
    </div>

    <div class="live-stream-expandable-panel" *ngIf="liveStreamExpandablePanelActive" [@expandablePanelAnimation]="liveStreamExpandablePanelActive ? 'expanded' : 'collapsed'">
      <!-- <ng-container *ngIf="producer; else noProducer">
        <picture *ngIf="producer.image">
          <source [srcset]="producer.image.size['medium']" media="(max-width: 424px)">
          <source [srcset]="producer.image.size['medium_large']" media="(min-width: 425px) and (max-width: 639px)">
          <source [srcset]="producer.image.size['2048x2048']" media="(min-width: 640px)">
          <img [src]="producer.image.size['medium_large']" [alt]="producer.image.alt" />
        </picture>
        <h1>{{ producer.name }}</h1>
        <p>{{ producer.description }}</p>
      </ng-container>
      <ng-template #noProducer>
        <p>No producer found</p>
      </ng-template>

      <schedule></schedule> -->

      <div class="container">
        Live stream data.
      </div>

    </div>
  </ng-container>

  <ng-container *ngSwitchCase="'onDemandStream'">
    <div class="stream on-demand-stream">
      <div class="container">
        <div class="channel"></div>

        <div class="toggle-play" [class.loading]="(onDemandStreamLoading$ | async)" [class.playing]="(onDemandStreamPlaying$ | async)" (click)="onDemandStreamTogglePlay()">
          <div class="loader" *ngIf="(onDemandStreamLoading$ | async); else onDemandStreamControls">
            <div class="spinner"></div>
          </div>

          <ng-template #onDemandStreamControls>
            <div class="symbol">{{ (onDemandStreamPlaying$ | async) ? 'pause' : 'play_arrow' }}</div>
          </ng-template>

          <div class="stream-info" *ngIf="episode">{{ episode.title }}</div>
        </div>

        <div class="side-actions">
          <div class="back-to-live-stream symbol" (click)="backToLiveStream()">sync</div>
          <div class="toggle-expandable-panel" [class.active]="onDemandStreamExpandablePanelActive" (click)="onDemandStreamToggleExpandablePanel()">
            <span class="symbol">expand_more</span>
          </div>
        </div>
      </div>
    </div>

    <div class="on-demand-stream-expandable-panel" *ngIf="onDemandStreamExpandablePanelActive" [@expandablePanelAnimation]="onDemandStreamExpandablePanelActive ? 'expanded' : 'collapsed'">

      <ng-container *ngIf="episode">
        
        <div class="wrapper">
      
          <picture *ngIf="episode.image">
            <source [srcset]="episode.image.size['medium']" media="(max-width: 424px)">
            <source [srcset]="episode.image.size['medium_large']" media="(min-width: 425px) and (max-width: 639px)">
            <source [srcset]="episode.image.size['2048x2048']" media="(min-width: 640px)">
            <img [src]="episode.image.size['medium_large']" [alt]="episode.image.alt" />
          </picture>

          <div class="channel">Archive</div>
              
          <div class="content">
            <div class="title"><a (click)="navigateAfterClosePanel(['/episode', episode.id])"> {{ episode.title }}</a></div>

            <div class="location-date">{{ episode.location }}, {{ episode.date | date:'dd.MM.yy' }}</div>

            <div class="shows" *ngIf="episode.shows && episode.shows.length">
              <span>Hosted on </span>
              <ng-container *ngFor="let show of episode.shows; let last = last">
                <a (click)="navigateAfterClosePanel(['/show', show.id])">{{ show.name }}<ng-container *ngIf="!last">,</ng-container></a>
              </ng-container>
            </div>

            <div class="producers" *ngIf="episode.producers && episode.producers.length">
              <span>With </span>
              <ng-container *ngFor="let producer of episode.producers; let last = last">
                <a (click)="navigateAfterClosePanel(['/producer', producer.id])">{{ producer.name }}<ng-container *ngIf="!last">,&nbsp;</ng-container></a>
              </ng-container>
            </div>
          </div>

        </div>
      </ng-container>

      <div class="progress-bar">
        <div class="container">
          <time>{{ formatTime(onDemandStreamCurrentTime$ | async) }}</time>
          <input type="range" min="0" [max]="onDemandStreamDuration$ | async" [value]="onDemandStreamCurrentTime$ | async" (input)="onScrub($event)" />
          <time>{{ formatTime(onDemandStreamDuration$ | async) }}</time>
        </div>
       </div>

    </div>

  </ng-container>

</div>

