<div class="audio-player" #audioPlayer [ngSwitch]="(streamTypeSelected$ | async)">

  <ng-container *ngSwitchCase="'liveStream'">
    <div class="stream live-stream" >
      <div class="container" >
        <div class="channel">Live Now</div>

        <div class="toggle-play" [class.loading]="(liveStreamLoading$ | async)" [class.playing]="(liveStreamPlaying$ | async)" (click)="liveStreamTogglePlay()">
          <div class="loader" *ngIf="(liveStreamLoading$ | async); else liveStreamControls">
            <div class="spinner"></div>
          </div>

          <ng-template #liveStreamControls>
            <div class="symbol">{{ (liveStreamPlaying$ | async) ? 'stop' : 'play_arrow' }}</div>
          </ng-template>

          <div class="stream-info">{{liveStreamEpisode?.artist}} - {{liveStreamEpisode?.title}}</div>
        </div>

        <div class="side-actions">
          <div class="toggle-expandable-panel" [class.active]="liveStreamExpandablePanelActive" (click)="liveStreamToggleExpandablePanel()">
            <span class="symbol">expand_more</span>
          </div>
        </div>
      </div>
    </div>

    <div class="live-stream-expandable-panel" *ngIf="liveStreamExpandablePanelActive" [@expandablePanelAnimation]="liveStreamExpandablePanelActive ? 'expanded' : 'collapsed'">
      <ng-container *ngIf="producer; else noProducer">
        <picture *ngIf="producer.image">
          <source [srcset]="producer.image.size['medium']" media="(max-width: 424px)">
          <source [srcset]="producer.image.size['medium_large']" media="(min-width: 425px) and (max-width: 639px)">
          <source [srcset]="producer.image.size['2048x2048']" media="(min-width: 640px)">
          <img [src]="producer.image.size['medium_large']" [alt]="producer.image.alt" />
        </picture>
        <h1>{{ producer.name }}</h1>
        <p>{{ producer.description }}</p>
      </ng-container>
      <ng-template #noProducer>
        <p>No producer found</p>
      </ng-template>

      <schedule></schedule>

    </div>
  </ng-container>

  <ng-container *ngSwitchCase="'onDemandStream'">
    <div class="stream on-demand-stream">
      <div class="container">
        <div class="channel">On Demand</div>

        <div class="toggle-play" [class.loading]="(onDemandStreamLoading$ | async)" [class.playing]="(onDemandStreamPlaying$ | async)" (click)="onDemandStreamTogglePlay()">
          <div class="loader" *ngIf="(onDemandStreamLoading$ | async); else onDemandStreamControls">
            <div class="spinner"></div>
          </div>

          <ng-template #onDemandStreamControls>
            <div class="symbol">{{ (onDemandStreamPlaying$ | async) ? 'pause' : 'play_arrow' }}</div>
          </ng-template>

          <div class="stream-info" *ngIf="episode">{{ episode.title }}</div>
        </div>

        <div class="side-actions">
          <div class="back-to-live-stream symbol" (click)="backToLiveStream()">sync</div>
          <div class="toggle-expandable-panel" [class.active]="onDemandStreamExpandablePanelActive" (click)="onDemandStreamToggleExpandablePanel()">
            <span class="symbol">expand_more</span>
          </div>
        </div>
      </div>
    </div>

    <div class="on-demand-stream-expandable-panel" *ngIf="onDemandStreamExpandablePanelActive" [@expandablePanelAnimation]="onDemandStreamExpandablePanelActive ? 'expanded' : 'collapsed'">
      <ng-container *ngIf="episode">
        <div class="grid">
          <picture *ngIf="episode.image">
            <source [srcset]="episode.image.size['medium']" media="(max-width: 424px)">
            <source [srcset]="episode.image.size['medium_large']" media="(min-width: 425px) and (max-width: 639px)">
            <source [srcset]="episode.image.size['2048x2048']" media="(min-width: 640px)">
            <img [src]="episode.image.size['medium_large']" [alt]="episode.image.alt" />
          </picture>
          <div class="content">
            <div class="wrapper">
              <h1 class="title">{{ episode.title }}</h1>
              <p>{{ episode.date | date:'dd.MM.yy' }} | {{ episode.location }}</p>
              <div class="description" [innerHTML]="episode.content"></div>

              <div>{{ episode.date | date:'dd.MM.yy' }}</div>

              <ng-container *ngIf="episode.producers?.length">
                <div class="producers">
                  <h2>Producers</h2>
                  <ul>
                    <li *ngFor="let producer of episode.producers">
                      <h1>{{ producer.name }}</h1>
                      <p>{{ producer.description }}</p>
                      <a class="underline" [routerLink]="['/producer', producer.id]">{{ producer.name }}</a>
                      <picture *ngIf="producer.image">
                        <source [srcset]="producer.image.size['medium']" media="(max-width: 424px)">
                        <source [srcset]="producer.image.size['medium_large']" media="(min-width: 425px) and (max-width: 639px)">
                        <source [srcset]="producer.image.size['2048x2048']" media="(min-width: 640px)">
                        <img [src]="producer.image.size['medium_large']" [alt]="producer.image.alt" />
                      </picture>
                    </li>
                  </ul>
                </div>
              </ng-container>

            </div>
          </div>
        </div>
      </ng-container>

      <div class="progress-bar">
        <div class="container">
          <time>{{ formatTime(onDemandStreamCurrentTime$ | async) }}</time>
          <input type="range" min="0" [max]="onDemandStreamDuration$ | async" [value]="onDemandStreamCurrentTime$ | async" (input)="onScrub($event)" />
          <time>{{ formatTime(onDemandStreamDuration$ | async) }}</time>
        </div>
       </div>

    </div>

  </ng-container>

</div>

